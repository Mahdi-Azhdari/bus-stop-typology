import math
from pathlib import Path

import numpy as np
import pandas as pd

import matplotlib.pyplot as plt
import matplotlib.ticker as mtick
from matplotlib import cm

import seaborn as sns
from pandas.plotting import parallel_coordinates

from sklearn.preprocessing import StandardScaler, label_binarize
from sklearn.mixture import GaussianMixture
from sklearn.model_selection import train_test_split, GridSearchCV, StratifiedKFold
from sklearn.pipeline import Pipeline

from sklearn.linear_model import LogisticRegression
from sklearn.neural_network import MLPClassifier
from sklearn.svm import SVC
from sklearn.ensemble import RandomForestClassifier

from sklearn.metrics import (
    accuracy_score, f1_score, log_loss,
    precision_score, recall_score, roc_auc_score,
    confusion_matrix, classification_report,
    precision_recall_fscore_support, roc_curve, auc
)

from sklearn.inspection import permutation_importance

import shap

# Optional: only used if installed
try:
    from xgboost import XGBClassifier
    HAS_XGB = True
except Exception:
    HAS_XGB = False

try:
    from lightgbm import LGBMClassifier
    HAS_LGBM = True
except Exception:
    HAS_LGBM = False
